---
- name: "Manage PostgreSQL database"
  community.postgresql.postgresql_db:
    ca_cert: "{{ item['ca_cert'] | default(omit) }}"
    conn_limit: "{{ item['conn_limit'] | default(omit) }}"
    connect_params: "{{ item['connect_params'] | default(omit) }}"
    dump_extra_args: "{{ item['dump_extra_args'] | default(omit) }}"
    encoding: "{{ item['encoding'] | default(omit) }}"
    force: "{{ item['force'] | default(omit) }}"
    lc_collate: "{{ item['lc_collate'] | default(omit) }}"
    lc_ctype: "{{ item['lc_ctype'] | default(omit) }}"
    login_host: "{{ item['login_host'] | default(omit) }}"
    login_password: "{{ item['login_password'] | default(omit) }}"
    login_port: "{{ item['login_port'] | default(omit) }}"
    login_unix_socket: "{{ item['login_unix_socket'] | default(omit) }}"
    login_user: "{{ item['login_user'] | default(omit) }}"
    maintenance_db: "{{ item['maintenance_db'] | default(omit) }}"
    name: "{{ item['name'] | mandatory }}"
    owner: "{{ item['owner'] | default(omit) }}"
    session_role: "{{ item['session_role'] | default(omit) }}"
    ssl_cert: "{{ item['ssl_cert'] | default(omit) }}"
    ssl_key: "{{ item['ssl_key'] | default(omit) }}"
    ssl_mode: "{{ item['ssl_mode'] | default(omit) }}"
    state: "{{ item['state'] | default(omit) }}"
    tablespace: "{{ item['tablespace'] | default(omit) }}"
    target: "{{ item['target'] | default(omit) }}"
    target_opts: "{{ item['target_opts'] | default(omit) }}"
    template: "{{ item['template'] | default(omit) }}"
    trust_input: "{{ item['trust_input'] | default(omit) }}"
  loop: "{{ postgresql_databases }}"
  loop_control:
    label: "{{ item['name'] }} state={{ item['state'] | default('present') }}"
